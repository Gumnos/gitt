<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Git In The Trenches</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<link type="text/css" href="menu.css" rel="stylesheet" />
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-228354-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>
<table width="1000" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td class="logo"><a href="index.html"><img src="images/git_logo_new.png" alt="Git In The Trenches" height="61" border="0"></a></td>
            <td class="nav">
				<a href="index.html">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="download.html">Download Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="intro.html">Read Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="http://github.com/cbx33/gitt">Source</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="feedback.html">Feeback</a>
			</td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td class="main_content_pad"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="309"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="subnav">
				<strong>Introduction</strong><br>
&bull;&nbsp;&nbsp;<a href="intro.html">How this book works</a><br>
<div class="divider"></div>
<strong>Setting up</strong><br>
&bull;&nbsp;&nbsp;<a href="setup.html">Making sure you have everything</a><br>
<div class="divider"></div>
<strong>Week 1</strong><br>
<span>&bull; Day 1 </span> - <a href="chap1-1.html"> "Things need to change"</a><br>
<span>&bull; Day 3 </span> - <a href="chap1-2.html"> "A possible solution"</a><br>
<span>&bull; Day 4 </span> - <a href="chap1-3.html"> "A decision is reached"</a><br>
<span>&bull; Day 5 </span> - <a href="chap1-4.html"> "Working like a team"</a><br>
<div class="divider"></div>
<strong>After Hours Week 1</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours1-1.html">"History Lesson"</a><br>
<div class="divider"></div>
<strong>Week 2</strong><br>
<span>&bull; Day 1 </span> - <a href="chap2-1.html"> "We are coders, we use Git!"</a><br>
<span>&bull; Day 2 </span> - <a href="chap2-2.html"> "Making commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap2-3.html"> "Let's do this right, not fast"</a><br>
<span>&bull; Summary </span> - <a href="chap2-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 2</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours2-1.html">"A Little Of Git's Internals"</a><br>
<div class="divider"></div>
<strong>Week 3</strong><br>
<span>&bull; Day 1 </span> - <a href="chap3-1.html"> "How do I see what's going on?"</a><br>
<span>&bull; Day 2 </span> - <a href="chap3-2.html"> "But I need more information"</a><br>
<span>&bull; Day 3 </span> - <a href="chap3-3.html"> "What actually changed?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap3-4.html"> "Finding a good reference point"</a><br>
<span>&bull; Day 5 </span> - <a href="chap3-5.html"> "Putting things back again"</a><br>
<span>&bull; Summary </span> - <a href="chap3-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 3</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours3-1.html">"A Closer Look At Diffs and Tags"</a><br>
<div class="divider"></div>
<strong>Week 4</strong><br>
<span>&bull; Day 1 </span> - <a href="chap4-1.html"> "We're getting somewhere"</a><br>
<span>&bull; Day 2 </span> - <a href="chap4-2.html"> "Branches galore"</a><br>
<span>&bull; Day 3 </span> - <a href="chap4-3.html"> "Tricking the twigs"</a><br>
<span>&bull; Day 4 </span> - <a href="chap4-4.html"> "I pressed delete..."</a><br>
<span>&bull; Day 5 </span> - <a href="chap4-5.html"> "Conflicting information"</a><br>
<span>&bull; Summary </span> - <a href="chap4-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 4</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-1.html">"Merge merge merge"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-2.html">"Grepping your life away"</a><br>
<div class="divider"></div>
<strong>Week 5</strong><br>
<span>&bull; Day 1 </span> - <a href="chap5-1.html"> "This isn't working for me John"</a><br>
<span>&bull; Day 2 </span> - <a href="chap5-2.html"> "Back to logging"</a><br>
<span>&bull; Day 4 </span> - <a href="chap5-3.html"> "Advanced Techniques"</a><br>
<span>&bull; Summary </span> - <a href="chap5-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 5</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours5-1.html">"Splitting up commits the easy way"</a><br>
<div class="divider"></div>
<strong>Week 6</strong><br>
<span>&bull; Day 1 </span> - <a href="chap6-1.html"> "My private little stash"</a><br>
<span>&bull; Day 2 </span> - <a href="chap6-2.html"> "What?! No backup?"</a><br>
<span>&bull; Day 3 </span> - <a href="chap6-3.html"> "Is this clone for real?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap6-4.html"> "Help I'm no longer up to date?"</a><br>
<span>&bull; Day 5 </span> - <a href="chap6-5.html"> "I'm putting my foot down"</a><br>
<span>&bull; Summary </span> - <a href="chap6-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 6</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-1.html">"Tug of war"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-2.html">"Referring to objects"</a><br>
<div class="divider"></div>
<strong>Week 7</strong><br>
<span>&bull; Day 1 </span> - <a href="chap7-1.html"> "Networking with a difference"</a><br>
<span>&bull; Day 2 </span> - <a href="chap7-2.html"> "Now let's work together"</a><br>
<span>&bull; Day 3 </span> - <a href="chap7-3.html"> "Rebasing our commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap7-4.html"> "Starting to get rebased"</a><br>
<span>&bull; Day 5 </span> - <a href="chap7-5.html"> "I could rebase the world"</a><br>
<span>&bull; Summary </span> - <a href="chap7-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 7</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours7-1.html">"Network Communicating"</a><br>
<div class="divider"></div>
<strong>Week 8</strong><br>
<span>&bull; Day 1 </span> - <a href="chap8-1.html"> "Give a man a patch"</a><br>
<span>&bull; Day 2 </span> - <a href="chap8-2.html"> "Looking for problems"</a><br>
<span>&bull; Day 3 </span> - <a href="chap8-3.html"> "Filtered repos"</a><br>
<span>&bull; Day 4 </span> - <a href="chap8-4.html"> "Let's make a library"</a><br>
<span>&bull; Day 5 </span> - <a href="chap8-5.html"> "Shhh....we're in a library"</a><br>
<span>&bull; Summary </span> - <a href="chap8-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 8</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours8-1.html">"Fishing for beginners"</a><br>
<div class="divider"></div>
<strong>A little extra help</strong><br>
&bull;&nbsp;&nbsp;<a href="chap9-1.html">Taking things further</a><br>
&bull;&nbsp;&nbsp;<a href="chap9-2.html">The end of the journey</a><br>
<div class="divider"></div>

				
				<td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table>              <h1>&nbsp;</h1>
              </td>
            <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="read_content">
<h1>Week 3</h1><h2>Day 5 - "Putting things back again"</h2>
<h3>Revert, I say. Revert!</h3>
Whilst working with your repository, something occurs quite often, is the need to go back in time, either temporarily or permanently, or even partially.
Git allows you to do this in a multitude of ways.
Let's see a real life situation where this need could arise.<br><div id="trenchblock"><strong>In the trenches...</strong><br>
"No, I don't have a copy of the file.
I was stupid and after I submitted it to you I er... deleted it".<br><br>John gave Michael the raised eyebrow look.
It wasn't the first time Michael had come to him with a similar problem.
Usually John would have had Michael go rooting through the archives to find it.
This time though, he wondered if Git might just come to the rescue.<br><br>"Tell ya what Michael," he grinned,
"Since this isn't the first time you've come to me with this kind of predicament, why don't you go and find out how to use Git to get the file back." Michael sighed.
"I have tagged the repo each time we created an archive, so tell me what I need to run to extract it."<br><br> * * * <br><br>"Man", started Michael running over to John's desk forty five minutes later.
"I never knew there were so many ways to skin a cat"<br><br>Michael was a little out of shape and though he had only crossed a minor distance, he now stood there, leaned over John's desk ever so slightly out of breath.<br><br>"So, you learn much?" asked John.<br><br>"Where d'ya want me to start?"<br></div><br>Where exactly do we start? Well one of the neat things about Git is that there are many ways to produce the same result.
While that may not seem like a benefit now, the trick is knowing just how to use each tool and what the benefit is of each method.
Right now, we are ready to look at four methods for achieving the task of viewing old information in the repository.
So how do we choose which method we wish to use? We need to answer a few more questions before we are ready to decide.<br><br>The table below shows the three methods that we have access to now.
Note that this may not be a definitive list of methods, but that these can give us access to the data we need to view.
The columns are requirements or criteria.
We need to evaluate each command in order to determine which one is right for us.
Once you have been using Git a while, these kind of evaluations will become second nature to you, but right now, we will take a look at all available options, just to see what is out there.<br>
<center>
  <table><tr><td>
</td></tr><tr><td>
    Method Name</td><td>
    Alters Repository</td><td>
    Changes History</td><td>
    Alters Working Copy</td><td>
    Reversible</td><td>
    Multiple Files</td></tr><tr><td>
    Reset</td><td>Possibly</td><td>Possibly</td><td>Possibly</td><td>Possibly</td><td>Yes</td></tr><tr><td>
    Checkout</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>
    Show</td><td>No</td><td>No</td><td>No</td><td>N/A</td><td>No</td></tr>
  </table>
</center>
<br>Let's take a look at each of these in turn.
We are going to be covering two new commands and revisiting an old one.
Let us start with <code class="ncode">git reset</code>.
We have already met this tool once.
When we used it previously, its purpose was to pull files out of the index that we were not ready to commit.
We were using <code class="ncode">git reset</code> in its simplest state.
Actually Git can perform several other kinds of reset.
It should be noted here that using this can be quite dangerous as it can affect your index, your working copy, your branch and the pointer HEAD.<br><br>In order to use <code class="ncode">git reset</code> in any sane way to achieve our goal, we would need to look at branching, which at the moment, we are not ready to do.
In short <code class="ncode">git reset</code> can drastically effect your working copy, affecting multiple files, and before we begin investigating, we really need to learn how to play in a safe environment.<br><br>The next method on our list to discuss is the <code class="ncode">git checkout</code> command.
This command can be used to bring back either a single file or multiple files and once again at this stage, is best employed in conjunction with branches.
At this point, you may be wondering why we are placing such emphasis on the use of branches.
As you will see next week, branches are incredibly powerful things, which allow you to experiment and play with your data, without the risk of losing anything.
<code class="ncode">git checkout</code> will pull files from a previous commit into our working copy.
This is something remember.
If we have any changes in our working copy, the checkout will fail.<br><br>The last method we can use to view data which was in a previous commit, is the <code class="ncode">git show</code> command.
This command literally pulls data from a previous version and dumps it to the standard output, a little like the <code class="ncode">cat</code> command present in almost every single *nix environment.<br><br>Now that we have taken a quick look at our three methods, we must decide which one is going to be the most useful to us.
Looking at the scenario above, we can deduce that we really only need to pull out one file.
If our intention was to do large amounts of work on an old branch and pull many files from it, <code class="ncode">git reset</code> may have been a good choice.
As we are looking for only a single file, we should consider looking at the checkout and show tools.<br><br>So now let us see how we can use <code class="ncode">git checkout</code> to take one of our files back to the past.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git status</strong><br/>
# On branch master<br/>
nothing to commit (working directory clean)<br/>
<strong>john@satsuki:~/coderepo$ git checkout v0.9 -- my_second_committed_file</strong><br/>
<strong>john@satsuki:~/coderepo$ cat my_second_committed_file</strong><br/>
Change1<br/>
<strong>john@satsuki:~/coderepo$ git checkout HEAD -- my_second_committed_file</strong><br/>
<strong>john@satsuki:~/coderepo$ cat my_second_committed_file</strong><br/>
Changed this file completely<br/>
<strong>john@satsuki:~/coderepo$</strong><br/>
</code></div><br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git status</strong><br/>
# On branch master<br/>
nothing to commit (working directory clean)<br/>
<strong>john@satsuki:~/coderepo$ git checkout v0.9 -- my_second_committed_file</strong><br/>
<strong>john@satsuki:~/coderepo$ git status</strong><br/>
# On branch master<br/>
# Changes to be committed:<br/>
#   (use "git reset HEAD &lt;file&gt;..." to unstage)<br/>
#<br/>
#	modified:   my_second_committed_file<br/>
#<br/>
<strong>john@satsuki:~/coderepo$ git checkout HEAD -- my_second_committed_file</strong><br/>
<strong>john@satsuki:~/coderepo$ git status</strong><br/>
# On branch master<br/>
nothing to commit (working directory clean)<br/>
<strong>john@satsuki:~/coderepo$</strong><br/>
</code></div><br>Notice how we first checked that we didn't have any local modifications by running the <code class="ncode">git status</code> command.
Then we are safe to run the <code class="ncode">git checkout</code> command.
We used the <code class="ncode">v0.9</code> tag from earlier to refer to an earlier commit state.
The next part of the command is the double hyphen (<code class="ncode">--</code>) that tells Git that what comes after it is the path.
Finally we choose <code class="ncode">my_second_committed_file</code> as the source file.
After this, when we <code class="ncode">cat</code> the file, we see that it has changed to what it used to be in <code class="ncode">v0.9</code>.<br><br>We then switch the file back to the latest version by using the <code class="ncode">HEAD</code> reference.
Note that on the odd occasion, the <code class="ncode">HEAD</code> reference doesn't always point to where you think it does, but this is an area we are yet to cover.
Then we run the command one more time, but this time we intersperse it with a <code class="ncode">git status</code> to see that there are changes made to out local working copy.<br><h3>Show me the money</h3>
The <code class="ncode">git show</code> command will have largely the same effect, except it grabs us the data without having to change existing files in our working copy.
Let us view a quick example.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git show v0.9:my_second_committed_file</strong><br/>
Change1<br/>
<strong>john@satsuki:~/coderepo$ git show v0.9:my_second_committed_file &gt; temp_file</strong><br/>
<strong>john@satsuki:~/coderepo$ cat temp_file</strong><br/>
Change1<br/>
<strong>john@satsuki:~/coderepo$</strong><br/>
</code></div><br>The format of the <code class="ncode">git show</code> command is rather similar to the checkout command we used a few moments ago.
The only difference is the presence of the colon, instead of the double hyphen.
Notice how the effect of the first command is just to print out the contents of the requested file to the screen.
With the Linux environment it is easy to pipe this output to a new file.
In the example above, we pipe the output using the <code class="ncode">&gt;</code> character to the file called <code class="ncode">temp_file</code><br><br>Hopefully you can now see that there are often several ways to achieve the same result and it is important to ensure that you choose the right tool for the job.
The reset command was too dangerous to use, the checkout command modified our working copy, but the show tool allowed us to create a new file, guaranteeing that our working copy remained untouched.<br><div id="trenchblock"><strong>In the trenches...</strong><br>
"So, if I am currently have changes to the file you want, in my local repository," began John,
"What command would you recommend I use?"<br><br>Michael paused, clearly considering each method in his head.
The noise from the sandwich van's horn rang through the office and Michael immediately stood bolt upright and looked panicked.
"The van John" he stuttered, "The van"<br><br>"You can go to the van when you tell me which command I should use." John smirked.
Michael was one of the more junior members of the team and the managers often took the opportunity to haze him.<br><br>"I'm gonna go with git show," he said in a rush.<br><br>"Why?" asked John.<br><br>"So you don't harm the working tree." replied Michael smoothly, already walking out the door.<br><br>"You could have also branched," shouted Rob, who was a few steps ahead of him.<br><br> * * * <br><br>"So, what's the status then John?" asked Markus.<br><br>John pressed a button on his laptop and the slideshow on the screen advanced to show an organisational model.
"Well, we've not had a whole lot of time this week as the release for project Manta, but we've managed to look at logging and diffing, which is something that we really needed to cover. Klaus also showed everyone how to tag things and went through our version numbering system again as several people had forgotten."
Everyone in the room looked at Jack.
"We also found out about how to pull older versions out of the repository in a variety of ways."<br><br>Markus looked pleased, "So, what's next?"<br><br>"Klaus?" asked John.<br><br>"Next, John put my team in charge of defining and teaching everyone about branching and merging. This is the really important stuff."
Klaus took over control of the laptop and clicked onto the next slide, which detailed a list of features.
"We really need to get a good handle on these topics to be successful. It is key to collaboration"<br><br>"Well done team," ended Markus,
"Wayne is going to be impressed with this."<br></div><br>We now have a good working knowledge of how to do many key things in Git.
Logging and diffing is supremely important for inspecting what changes have occurred in the repository.
Though the options here are not an exhaustive list, they should give you a basic understanding of how to use the tools.
It is well worth looking at the man pages for these commands to get an idea of just how expansive they can be.
For example, the diff tool can not only show you differences between your working copy and the index, but also between your index and the latest commit, using the <code class="ncode">cached</code> option.<br><br>Next we move on to branching and merging.
Branching can be a tricky subject, so it is important to understand what is happening at the repository level.
It would be prudent to look over the <em>After Hours</em> section for Week 2 before continuing as some of the terminology may be a little confusing otherwise.<br><br><table border="0" cellpadding="0" cellspacing="0" width="100%">
					<tr>
						<td><p align="left"><a href="chap3-4.html"><img src="images/prev.png" alt="Previous Day" height="29" border="0"></a></p></td>
						<td><p align="right"><a href="chap3-6.html"><img src="images/next.png" alt="Next Day" height="29" border="0"></a></p></td>
					</tr>
				</table>                  </td>
                <td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table></td>
            </tr>
          </table>
		</td>
      </tr>
      <tr>
        <td class="foot"><a href="index.html">home</a> | <a href="download.html">download</a> | <a href="read.html">read now</a> | <a href="source.html">source</a> | <a href="feedback.html">feedback</a> | <a href="legal.html">legal stuff</a><br>
        </td>
      </tr>
    </table></td>
  </tr>
</table>
</body>
</html>
