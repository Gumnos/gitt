<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Git In The Trenches</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<link type="text/css" href="menu.css" rel="stylesheet" />
	<script type="text/javascript" src="jquery.js"></script>
</head>

<body>
<table width="1000" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td class="logo"><a href="index.html"><img src="images/git_logo_new.png" alt="Git In The Trenches" height="61" border="0"></a></td>
            <td class="nav">
				<a href="index.html">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="download.html">Download Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="intro.html">Read Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="http://github.com/cbx33/gitt">Source</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="feedback.html">Feeback</a>
			</td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td class="main_content_pad"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="309"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="subnav">
				<strong>Introduction</strong><br>
&bull;&nbsp;&nbsp;<a href="intro.html">How this book works</a><br>
<div class="divider"></div>
<strong>Setting up</strong><br>
&bull;&nbsp;&nbsp;<a href="setup.html">Making sure you have everything</a><br>
<div class="divider"></div>
<strong>Week 1</strong><br>
<span>&bull; Day 1 </span> - <a href="chap1-1.html"> "Things need to change"</a><br>
<span>&bull; Day 3 </span> - <a href="chap1-2.html"> "A possible solution"</a><br>
<span>&bull; Day 4 </span> - <a href="chap1-3.html"> "A decision is reached"</a><br>
<span>&bull; Day 5 </span> - <a href="chap1-4.html"> "Working like a team"</a><br>
<div class="divider"></div>
<strong>After Hours Week 1</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours1-1.html">"History Lesson"</a><br>
<div class="divider"></div>
<strong>Week 2</strong><br>
<span>&bull; Day 1 </span> - <a href="chap2-1.html"> "We are coders, we use Git!"</a><br>
<span>&bull; Day 2 </span> - <a href="chap2-2.html"> "Making commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap2-3.html"> "Let's do this right, not fast"</a><br>
<span>&bull; Summary </span> - <a href="chap2-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 2</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours2-1.html">"A Little Of Git's Internals"</a><br>
<div class="divider"></div>
<strong>Week 3</strong><br>
<span>&bull; Day 1 </span> - <a href="chap3-1.html"> "How do I see what's going on?"</a><br>
<span>&bull; Day 2 </span> - <a href="chap3-2.html"> "But I need more information"</a><br>
<span>&bull; Day 3 </span> - <a href="chap3-3.html"> "What actually changed?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap3-4.html"> "Finding a good reference point"</a><br>
<span>&bull; Day 5 </span> - <a href="chap3-5.html"> "Putting things back again"</a><br>
<span>&bull; Summary </span> - <a href="chap3-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 3</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours3-1.html">"A Closer Look At Diffs and Tags"</a><br>
<div class="divider"></div>
<strong>Week 4</strong><br>
<span>&bull; Day 1 </span> - <a href="chap4-1.html"> "We're getting somewhere"</a><br>
<span>&bull; Day 2 </span> - <a href="chap4-2.html"> "Branches galore"</a><br>
<span>&bull; Day 3 </span> - <a href="chap4-3.html"> "Tricking the twigs"</a><br>
<span>&bull; Day 4 </span> - <a href="chap4-4.html"> "I pressed delete..."</a><br>
<span>&bull; Day 5 </span> - <a href="chap4-5.html"> "Conflicting information"</a><br>
<span>&bull; Summary </span> - <a href="chap4-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 4</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-1.html">"Merge merge merge"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-2.html">"Grepping your life away"</a><br>
<div class="divider"></div>
<strong>Week 5</strong><br>
<span>&bull; Day 1 </span> - <a href="chap5-1.html"> "This isn't working for me John"</a><br>
<span>&bull; Day 2 </span> - <a href="chap5-2.html"> "Back to logging"</a><br>
<span>&bull; Day 4 </span> - <a href="chap5-3.html"> "Advanced Techniques"</a><br>
<span>&bull; Summary </span> - <a href="chap5-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 5</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours5-1.html">"Splitting up commits the easy way"</a><br>
<div class="divider"></div>
<strong>Week 6</strong><br>
<span>&bull; Day 1 </span> - <a href="chap6-1.html"> "My private little stash"</a><br>
<span>&bull; Day 2 </span> - <a href="chap6-2.html"> "What?! No backup?"</a><br>
<span>&bull; Day 3 </span> - <a href="chap6-3.html"> "Is this clone for real?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap6-4.html"> "Help I'm no longer up to date?"</a><br>
<span>&bull; Day 5 </span> - <a href="chap6-5.html"> "I'm putting my foot down"</a><br>
<span>&bull; Summary </span> - <a href="chap6-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 6</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-1.html">"Tug of war"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-2.html">"Referring to objects"</a><br>
<div class="divider"></div>
<strong>Week 7</strong><br>
<span>&bull; Day 1 </span> - <a href="chap7-1.html"> "Networking with a difference"</a><br>
<span>&bull; Day 2 </span> - <a href="chap7-2.html"> "Now let's work together"</a><br>
<span>&bull; Day 3 </span> - <a href="chap7-3.html"> "Rebasing our commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap7-4.html"> "Starting to get rebased"</a><br>
<span>&bull; Day 5 </span> - <a href="chap7-5.html"> "I could rebase the world"</a><br>
<span>&bull; Summary </span> - <a href="chap7-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 7</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours7-1.html">"Network Communicating"</a><br>
<div class="divider"></div>
<strong>Week 8</strong><br>
<span>&bull; Day 1 </span> - <a href="chap8-1.html"> "Give a man a patch"</a><br>
<span>&bull; Day 2 </span> - <a href="chap8-2.html"> "Looking for problems"</a><br>
<span>&bull; Day 3 </span> - <a href="chap8-3.html"> "Filtered repos"</a><br>
<span>&bull; Day 4 </span> - <a href="chap8-4.html"> "Let's make a library"</a><br>
<span>&bull; Day 5 </span> - <a href="chap8-5.html"> "Shhh....we're in a library"</a><br>
<span>&bull; Summary </span> - <a href="chap8-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 8</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours8-1.html">"Fishing for beginners"</a><br>
<div class="divider"></div>
<strong>A little extra help</strong><br>
&bull;&nbsp;&nbsp;<a href="chap9-1.html">Taking things further</a><br>
&bull;&nbsp;&nbsp;<a href="chap9-2.html">The end of the journey</a><br>
<div class="divider"></div>

				
				<td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table>              <h1>&nbsp;</h1>
              </td>
            <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="read_content">
<h1>Week 4</h1><h2>Day 1 - "We're getting somewhere"</h2>
<h3>Planting trees</h3>
Tamagoyaki Inc have now realised that they have to take these things slow and steady if they want to implement a stable and robust system.
This week, they are going to start actually using branches and merging in changes, probably one of the largest topics to cover when doing any type of collaborative development.<br><div id="trenchblock"><strong>In the trenches...</strong><br>
"Dude!" shouted Eugene from across the office.
"Dude!!" he repeated.<br><br>No one looked up and the hum of the computers seemed to drown out the murmurs of voices and clicking of keys.<br><br>"Dud..."
He was cut off by another voice.
It was Klaus.<br><br>"Maybe if you gave us some indication of who you were addressing Eugene," said Klaus in his usual matter-of-factly tone,
"we may actually be able to help you."<br><br>"John!" Shouted Eugene, as if ignoring Klaus entirely.
The manager hadn't looked up from his monitor as he had advised the tools guy and he now sat there continuing to type with one hand, the other reaching over and yanking out the earbud that was playing a droning beat in John's ear.<br><br>"Ouch!" said John, slightly startled.<br><br>"Dork wants you," said Klaus, using his pet name for Eugene.<br><br>John walked over to Eugene.
"Sup?!"<br><br>"I don't get branches," said the developer.
"I mean I don't get what the heck they do, why I would ever want to use them, and how are they even different to tags anyway?"
</div><br>First, we should probably start off by answering that very question and describing what branches are and what they can be used for.
In Git, a branch is just a pointer to a commit in the repository.
At first glance this might not seem any different to a tag.
A tag points to a commit, so does a branch.
So what distinguishes between the two? Let us start playing with branches a little and the answer will become obvious in a while.
Branches allow you to try things out and even keep a history of the things you try without actually affecting your main branch.
In essence you are able to take things in a completely different direction, safe in the knowledge that your core code base will be safe.<br><br>This is best illustrated by a little demonstration, so we are going to take our testing repository and branch off to try out new, wonderful and wacky things.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ ls<br></strong>
my_first_committed_file   my_third_committed_file<br>
my_second_committed_file  temp_file<br>
<strong>john@satsuki:~/coderepo$ git branch wacky<br></strong>
<strong>john@satsuki:~/coderepo$ git branch<br></strong>
* master<br>
  wacky<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>From looking at the output, it would appear that our <code class="ncode">git branch wacky</code> command did not accomplish a whole lot.
Running the <code class="ncode">git branch</code> command will give us a list of all branches in the repository.
You may have noticed the presence of the <code class="ncode">*</code> in front of the word <code class="ncode">master</code>.
This is telling us that we are on the branch called <strong>master</strong>.
Hang on though, did we not just create a new branch called <strong>wacky</strong>?<br><br>Well yes we did.
However we have not yet switched to it.
To do this, we use our good friend <code class="ncode">git checkout</code>.
This will change the working copy to reflect the most recent commit in that branch, and will reset our HEAD accordingly, so that it points to this latest commit<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git checkout wacky<br></strong>
Switched to branch 'wacky'<br>
<strong>john@satsuki:~/coderepo$ git branch<br></strong>
  master<br>
* wacky<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>Now the <code class="ncode">*</code> has moved to be in front of the word <code class="ncode">wacky</code> and we have confirmation from the line above that we have in fact <code class="ncode">Switched to branch 'wacky'</code>.
Now we are here in wonderland, what can we do? Well, potentially anything we could do in our previous branch, but with the added benefit that we are separated.
Some of you maybe be thinking, but we never created an initial branch called <strong>master</strong>.
Whilst this is true in one sense, the <code class="ncode">git init</code> command actually created this branch for us when we initialised the repository.<br><br>We will start off by taking a deeper look at what is present in our branch.
Running a <code class="ncode">git log</code> shows us the history of our branch.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git log<br></strong>
commit a022d4d1edc69970b4e8b3fe1da3dccd943a55e4<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Thu Mar 31 22:05:55 2011 +0100<br>
<br>
    Messed with a few files<br>
<br>
commit 9938a0c30940dccaeddce4bb2eb151fba3a21ae5<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Thu Mar 31 20:34:23 2011 +0100<br>
<br>
    Finished adding initial files<br>
<br>
commit 163f06147a449e724d0cfd484c3334709e8e1fce<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Thu Mar 31 20:32:59 2011 +0100<br>
<br>
    Made a few changes to first and second files<br>
<br>
commit cfe23cbe0150fda69a004e301828097935ec4397<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Thu Mar 31 20:27:44 2011 +0100<br>
<br>
    My First Ever Commit<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>You may notice here that the log messages being displayed are identical to that which we had before in our <strong>master</strong> branch.
This is nothing to be worried about.
You may be wondering how these can be present if we are in a totally separate environment.
Well, though we have branched, the history that led us to this point is the same.
As we have not made any changes yet, we do not notice any divergence.
If we now make changes to the <em>repository</em> we can take a look and see how this will affect things.
To start with, let us remove a few files from the working tree, commit these actions, then add a few more, stage them and commit the new files.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git rm my_first_committed_file<br></strong>
rm 'my_first_committed_file'<br>
<strong>john@satsuki:~/coderepo$ git rm my_second_committed_file<br></strong>
rm 'my_second_committed_file'<br>
<strong>john@satsuki:~/coderepo$ git commit -m 'Removed a few files'<br></strong>
[wacky 4a155e4] Removed a few files<br>
 2 files changed, 0 insertions(+), 2 deletions(-)<br>
 delete mode 100644 my_first_committed_file<br>
 delete mode 100644 my_second_committed_file<br>
<strong>john@satsuki:~/coderepo$ echo "A new file" &gt; newfile1<br></strong>
<strong>john@satsuki:~/coderepo$ echo "Another new file" &gt; newfile2<br></strong>
<strong>john@satsuki:~/coderepo$ git add newfile*<br></strong>
<strong>john@satsuki:~/coderepo$ git commit -m 'Added two new files'<br></strong>
[wacky 55fb69f] Added two new files<br>
 2 files changed, 2 insertions(+), 0 deletions(-)<br>
 create mode 100644 newfile1<br>
 create mode 100644 newfile2<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>So we have made two new commits to the repository under our new branch.
If we run a Linux <code class="ncode">ls</code> command to see the files which are in the working tree, we can see that our working copy has indeed altered.
We will also use our <code class="ncode">git log</code> tool to see what the latest commit is.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ ls<br></strong>
my_third_committed_file  newfile1  newfile2  temp_file<br>
<strong>john@satsuki:~/coderepo$ git log -n1<br></strong>
commit 55fb69f4ad26fdb6b90ac6f43431be40779962dd<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Fri Apr 1 00:10:49 2011 +0100<br>
<br>
    Added two new files<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>Brilliant.
As you can see, we have used <code class="ncode">git log</code> in a slightly different way to limit the number of commits.
This is what the <code class="ncode">-n</code> parameter is used for.
However, what happens if we go back to the <strong>master</strong> branch again? In theory we should have everything back the way we left it just before creating the branch.
Let's move back into our <strong>master</strong> branch and examine the state of play.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git checkout master<br></strong>
Switched to branch 'master'<br>
<strong>john@satsuki:~/coderepo$ ls<br></strong>
my_first_committed_file   my_third_committed_file<br>
my_second_committed_file  temp_file<br>
<strong>john@satsuki:~/coderepo$ git log -n1<br></strong>
commit a022d4d1edc69970b4e8b3fe1da3dccd943a55e4<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Thu Mar 31 22:05:55 2011 +0100<br>
<br>
    Messed with a few files<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>Comparing that to our previous <code class="ncode">ls</code> command, we can see that this is exactly what the working tree looked like at the beginning of the chapter.
Let us take a look at a diagram of the commit history to see what has happened in our repository.<br><center><table  border="0" cellpadding="0" cellspacing="0" class="image_float_left">
                    <tr>
                      <td style="padding:10px;"><img src="images/chaps/f-w4-d1.png" width="400" ></td>
                      <td class="fade_right">&nbsp;</td>
                    </tr>
                    <tr>
                      <td class="fade_bot_image"><div align="center"><strong>Figure 1</strong><br>Our first branch</div></td>
                      <td class="fade_corner">&nbsp;</td>
                    </tr>
                  </table></center><br>So there are really two pointers in our repository at the moment, from a branch point of view.
One of them points to commit <strong>a022d4d...</strong> and is called <strong>master</strong>.
The other is called <strong>wacky</strong> and points to <strong>55fb69f...</strong>.
At this point you may be thinking that branches are pretty much the same thing as tags.
Well, they are except for one important fact.
We are going to use our <code class="ncode">git branch</code> command, with a new parameter, to show us the difference.
Take a look at the output of the following operations.
We have pruned the output of the <code class="ncode">git show</code> command for brevity.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ git checkout wacky<br></strong>
Switched to branch 'wacky'<br>
<strong>john@satsuki:~/coderepo$ git branch -v<br></strong>
  master a022d4d Messed with a few files<br>
* wacky  55fb69f Added two new files<br>
<strong>john@satsuki:~/coderepo$ git tag v2.0<br></strong>
<strong>john@satsuki:~/coderepo$ git show v2.0<br></strong>
commit 55fb69f4ad26fdb6b90ac6f43431be40779962dd<br>
...<br>
...<br>
...<br>
</code></div><br>So here we have added a tag in our current branch, <strong>wacky</strong>, and we can see that the commit ID for the tag <strong>v2.0</strong> points <strong>55fb69f</strong>.
We can also see that the branch <strong>wacky</strong> is currently pointing to the same commit ID, <strong>55fb69f</strong>.
Now let us add another file in, make a commit and see what happens after this.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo$ echo "New stuff" &gt; another_file<br></strong>
<strong>john@satsuki:~/coderepo$ git add another_file<br></strong>
<strong>john@satsuki:~/coderepo$ git commit -m 'Added another file'<br></strong>
[wacky 9710177] Added another file<br>
 1 files changed, 1 insertions(+), 0 deletions(-)<br>
 create mode 100644 another_file<br>
<strong>john@satsuki:~/coderepo$ git show v2.0<br></strong>
commit 55fb69f4ad26fdb6b90ac6f43431be40779962dd<br>
...<br>
...<br>
...<br>
<strong>john@satsuki:~/coderepo$ git branch -v<br></strong>
  master a022d4d Messed with a few files<br>
* wacky  9710177 Added another file<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</code></div><br>How interesting.
The difference between tags and branches now becomes pretty clear.
Whilst a tag always points to the same commit, a branch reference always points to the tip of that branch.
In essence the reference that a branch points to moves as subsequent commits are made.
By doing this, the whole history of the branch can be retraced.
Since we know the latest commit, we also know the parent of that commit and so on and so on.<br><br>Since a branch is just a pointer to a commit, performing operations like adding, modifying and deleting files in the repository can be done safely, without destroying any data in another branch.
In short, it will allow us to completely redesign whatever is being stored in the current branch without worrying about how it will affect our baseline.
For a developer, this is pretty crucial stuff.
This gives people the chance to play with their data and experiment, which is often where the greatest ideas come from.<br><br><table border="0" cellpadding="0" cellspacing="0" width="100%">
					<tr>
						<td><p align="left"><a href="afterhours3-1.html"><img src="images/prev.png" alt="Previous Day" height="29"></a></p></td>
						<td><p align="right"><a href="chap4-2.html"><img src="images/next.png" alt="Next Day" height="29"></a></p></td>
					</tr>
				</table>                  </td>
                <td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table></td>
            </tr>
          </table>
		</td>
      </tr>
      <tr>
        <td class="foot"><a href="index.html">home</a> | <a href="download.html">download</a> | <a href="read.html">read now</a> | <a href="source.html">source</a> | <a href="feedback.html">feedback</a> | <a href="legal.html">legal stuff</a><br>
        </td>
      </tr>
    </table></td>
  </tr>
</table>
</body>
</html>
