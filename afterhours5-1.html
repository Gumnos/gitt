<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Git In The Trenches</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<!--	<link type="text/css" href="menu.css" rel="stylesheet" />-->
<!--	<script type="text/javascript" src="jquery.js"></script>-->
<!--	<script type="text/javascript" src="menu.js"></script>-->
</head>

<body>
<table width="1000" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td class="logo"><a href="index.html"><img src="images/git_logo_new.png" alt="Git In The Trenches" height="61" border="0"></a></td>
            <td class="nav">
				<a href="index.html">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="download.html">Download Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="intro.html">Read Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="source.html">Source</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="feedback.html">Feeback</a>
			<!--<div id="menu">
		<ul class="menu">
			<li><a href="index.html" class="parent"><span>Home</span></a>
			</li>
			<li><a href="download.html"><span>Download Now</span></a></li>
			<li><a href="read.html"><span>Read Now</span></a><div><ul>
                <li><a href="#" class="parent"><span>Chapter 1</span></a>
                    <div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div>
                </li>
                <li><a href="#" class="parent"><span>Chapter 2</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
                <li><a href="#" class="parent"><span>Chapter 3</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
					<li><a href="#" class="parent"><span>Chapter 4</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
					<li><a href="#" class="parent"><span>Chapter 5</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
					<li><a href="#" class="parent"><span>Chapter 6</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
					<li><a href="#" class="parent"><span>Chapter 7</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
					<li><a href="#" class="parent"><span>Chapter 8</span></a>
				<div><ul>
                        <li><a href="#"><span>Day 1</span></a></li>
                        <li><a href="#"><span>Day 2</span></a></li>
                        <li><a href="#"><span>Day 3</span></a></li>
                        <li><a href="#"><span>Day 4</span></a></li>
                        <li><a href="#"><span>Day 5</span></a></li>
                        <li><a href="#"><span>Day 6</span></a></li>
                    </ul></div></li>
            </ul></div>
        </li>
			<li><a href="source.html"><span>Source</span></a></li>
			<li class="last"><a href="feedback.html"><span>Feedback</span></a></li>
		</ul>
	</div>-->
		</td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td class="main_content_pad"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="309"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="subnav">
				<strong>Introduction</strong><br>
&bull;&nbsp;&nbsp;<a href="intro.html">How this book works</a><br>
<div class="divider"></div>
<strong>Setting up</strong><br>
&bull;&nbsp;&nbsp;<a href="setup.html">Making sure you have everything</a><br>
<div class="divider"></div>
<strong>Week 1</strong><br>
<span>&bull; Day 1 </span> - <a href="chap1-1.html"> "Things need to change"</a><br>
<span>&bull; Day 3 </span> - <a href="chap1-2.html"> "A possible solution"</a><br>
<span>&bull; Day 4 </span> - <a href="chap1-3.html"> "A decision is reached"</a><br>
<span>&bull; Day 5 </span> - <a href="chap1-4.html"> "Working like a team"</a><br>
<div class="divider"></div>
<strong>After Hours Week 1</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours1-1.html">"History Lesson"</a><br>
<div class="divider"></div>
<strong>Week 2</strong><br>
<span>&bull; Day 1 </span> - <a href="chap2-1.html"> "We are coders, we use Git!"</a><br>
<span>&bull; Day 2 </span> - <a href="chap2-2.html"> "Making commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap2-3.html"> "Let's do this right, not fast"</a><br>
<span>&bull; Summary </span> - <a href="chap2-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 2</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours2-1.html">"A Little Of Git's Internals"</a><br>
<div class="divider"></div>
<strong>Week 3</strong><br>
<span>&bull; Day 1 </span> - <a href="chap3-1.html"> "How do I see what's going on?"</a><br>
<span>&bull; Day 2 </span> - <a href="chap3-2.html"> "But I need more information"</a><br>
<span>&bull; Day 3 </span> - <a href="chap3-3.html"> "What actually changed?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap3-4.html"> "Finding a good reference point"</a><br>
<span>&bull; Day 5 </span> - <a href="chap3-5.html"> "Putting things back again"</a><br>
<span>&bull; Summary </span> - <a href="chap3-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 3</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours3-1.html">"A Closer Look At Diffs and Tags"</a><br>
<div class="divider"></div>
<strong>Week 4</strong><br>
<span>&bull; Day 1 </span> - <a href="chap4-1.html"> "We're getting somewhere"</a><br>
<span>&bull; Day 2 </span> - <a href="chap4-2.html"> "Branches galore"</a><br>
<span>&bull; Day 3 </span> - <a href="chap4-3.html"> "Tricking the twigs"</a><br>
<span>&bull; Day 4 </span> - <a href="chap4-4.html"> "I pressed delete..."</a><br>
<span>&bull; Day 5 </span> - <a href="chap4-5.html"> "Conflicting information"</a><br>
<span>&bull; Summary </span> - <a href="chap4-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 4</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-1.html">"Merge merge merge"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-2.html">"Grepping your life away"</a><br>
<div class="divider"></div>
<strong>Week 5</strong><br>
<span>&bull; Day 1 </span> - <a href="chap5-1.html"> "This isn't working for me John"</a><br>
<span>&bull; Day 2 </span> - <a href="chap5-2.html"> "Back to logging"</a><br>
<span>&bull; Day 4 </span> - <a href="chap5-3.html"> "Advanced Techniques"</a><br>
<span>&bull; Summary </span> - <a href="chap5-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 5</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours5-1.html">"Splitting up commits the easy way"</a><br>
<div class="divider"></div>
<strong>Week 6</strong><br>
<span>&bull; Day 1 </span> - <a href="chap6-1.html"> "My private little stash"</a><br>
<span>&bull; Day 2 </span> - <a href="chap6-2.html"> "What?! No backup?"</a><br>
<span>&bull; Day 3 </span> - <a href="chap6-3.html"> "Is this clone for real?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap6-4.html"> "Help I'm no longer up to date?"</a><br>
<span>&bull; Day 5 </span> - <a href="chap6-5.html"> "I'm putting my foot down"</a><br>
<span>&bull; Summary </span> - <a href="chap6-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 6</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-1.html">"Tug of war"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-2.html">"Referring to objects"</a><br>
<div class="divider"></div>
<strong>Week 7</strong><br>
<span>&bull; Day 1 </span> - <a href="chap7-1.html"> "Networking with a difference"</a><br>
<span>&bull; Day 2 </span> - <a href="chap7-2.html"> "Now let's work together"</a><br>
<span>&bull; Day 3 </span> - <a href="chap7-3.html"> "Rebasing our commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap7-4.html"> "Starting to get rebased"</a><br>
<span>&bull; Day 5 </span> - <a href="chap7-5.html"> "I could rebase the world"</a><br>
<span>&bull; Summary </span> - <a href="chap7-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 7</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours7-1.html">"Network Communicating"</a><br>
<div class="divider"></div>
<strong>Week 8</strong><br>
<span>&bull; Day 1 </span> - <a href="chap8-1.html"> "Give a man a patch"</a><br>
<span>&bull; Day 2 </span> - <a href="chap8-2.html"> "Looking for problems"</a><br>
<span>&bull; Day 3 </span> - <a href="chap8-3.html"> "Filtered repos"</a><br>
<span>&bull; Day 4 </span> - <a href="chap8-4.html"> "Let's make a library"</a><br>
<span>&bull; Day 5 </span> - <a href="chap8-5.html"> "Shhh....we're in a library"</a><br>
<span>&bull; Summary </span> - <a href="chap8-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 8</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours8-1.html">"Fishing for beginners"</a><br>
<div class="divider"></div>
<strong>A little extra help</strong><br>
&bull;&nbsp;&nbsp;<a href="chap9-1.html">Taking things further</a><br>
&bull;&nbsp;&nbsp;<a href="chap9-2.html">The end of the journey</a><br>
<div class="divider"></div>

				
				<td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table>              <h1>&nbsp;</h1>
              </td>
            <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="read_content">
<h1>Week 5</h1><h2>"Splitting up commits the easy way"</h2>
<h3>Taking commits that little bit further</h3>
Sometimes, putting everything in a single commit just is not a good idea.
Imagine you have pulled in number of updates to your working directory.
You may want to split these up.
It is true that you could simply <span style="font-family:monospace;">git add</span> only the files you want to include in the commit.
However, what happens when you have change four or five different things in the same file, and you want to split that commit up into five different commits.<br><br>There are two ways you can approach this.
The first is to copy the file in question out of the working directory, reset the working copy back to the last committed and copy your changes in line by line.
This can be time consuming and frustrating and when you are working on many files, it can be totally impractical.
What we need is a way to include or exclude certain lines of a file.<br><br>To demonstrate this we are going to create a new branch called <strong>fantasy</strong> and we are going to make several changes to a few files.
We are then going to show how the same process can be achieved by using both the GUI and the command line.<br><br>So let us start by creating our branch and making some changes as shown below.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git checkout -b fantasy<br></strong>
Switched to a new branch 'fantasy'<br>
<strong>john@satsuki:~/coderepo$ echo "This is line 1" &gt; newfile1<br></strong>
<strong>john@satsuki:~/coderepo$ echo "This is line 2" &gt;&gt; newfile1<br></strong>
<strong>john@satsuki:~/coderepo$ echo "This is line 3" &gt;&gt; newfile1<br></strong>
<strong>john@satsuki:~/coderepo$ echo "This is line 4" &gt;&gt; newfile1<br></strong>
<strong>john@satsuki:~/coderepo$ echo "This is a new line" &gt;&gt; newfile2<br></strong>
<strong>john@satsuki:~/coderepo$ echo "This is another new line" &gt;&gt; newfile2<br></strong>
</div><br>Let us now just run a <span style="font-family:monospace;">git diff</span> to see exactly what the changes are.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git diff<br></strong>
diff --git a/newfile1 b/newfile1<br>
index 44640b2..0eccf1a 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
diff --git a/newfile2 b/newfile2<br>
index 3545c1d..40efcce 100644<br>
--- a/newfile2<br>
+++ b/newfile2<br>
@@ -1,2 +1,4 @@<br>
 Another new file<br>
 and a new awesome feature<br>
+This is a new line<br>
+This is another new line<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>Now, we could just do <span style="font-family:monospace;">git commit -a</span> and be done with it, but what if we really wanted to split this information up into four commits? We will introduce a new parameter to our <span style="font-family:monospace;">git add</span> tool from before.
We are going to use the <span style="font-family:monospace;">git add -p</span> or <span style="font-family:monospace;">git add --patch</span>.
This will allow us to interactively edit the hunks before they are committed.
To begin with, let us run <span style="font-family:monospace;">git add -p</span> and see what it is we need to do.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git add -p<br></strong>
diff --git a/newfile1 b/newfile1<br>
index 44640b2..0eccf1a 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
Stage this hunk [y,n,q,a,d,/,e,?]?<br>
</div><br>We are given the options of <span style="font-family:monospace;">y,n,q,a,d,/,e,?</span>.
At first glance, this may seem rather daunting.
Let us choose the <span style="font-family:monospace;">?</span> and see what help is presented to us.<br><div id="codeblock">Stage this hunk [y,n,q,a,d,/,e,?]? ?<br>
y - stage this hunk<br>
n - do not stage this hunk<br>
q - quit, do not stage this hunk nor any of the remaining ones<br>
a - stage this and all the remaining hunks in the file<br>
d - do not stage this hunk nor any of the remaining hunks in the file<br>
g - select a hunk to go to<br>
/ - search for a hunk matching the given regex<br>
j - leave this hunk undecided, see next undecided hunk<br>
J - leave this hunk undecided, see next hunk<br>
k - leave this hunk undecided, see previous undecided hunk<br>
K - leave this hunk undecided, see previous hunk<br>
s - split the current hunk into smaller hunks<br>
e - manually edit the current hunk<br>
? - print help<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
Stage this hunk [y,n,q,a,d,/,e,?]?<br>
</div><br>So it appears that Git is offering us the opportunity to either
<div style="padding-left:10px;"><ul>
<li>Stage it</li>
<li>Do not stage it</li>
<li>Quit,</li>
<li>Stage it and all remaining hunks</li>
<li>Do not stage it or any of the remaining ones</li>
<li>Search for a regex</li>
\item Edit the hunk
</ul></div><br>In fact, though the help mentioned a <strong>split</strong> command, we do not have this option available to us, due to the nature of our hunk.
Instead, if we wish to split this hunk, we are going to have to edit it manually.
To do this we will choose the <span style="font-family:monospace;">e</span> option.<br><br>Here we are left in our chosen text editor, to either add, modify or remove lines from the hunk.
In our case, we are going to delete a few lines.
We only want to leave the first line of additions.
Just because we delete the others does not mean they are deleted from the working copy.
Remember, we are not editing the actual files here.
Just the hunks that are going to be staged.<br><div id="codeblock"># Manual hunk edit mode -- see bottom for a quick guide<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
# ---<br>
# To remove '-' lines, make them ' ' lines (context).<br>
# To remove '+' lines, delete them.<br>
# Lines starting with # will be removed.<br>
#<br>
# If the patch applies cleanly, the edited hunk will immediately be<br>
# marked for staging. If it does not apply cleanly, you will be given<br>
# an opportunity to edit again. If all lines of the hunk are removed,<br>
# then the edit is aborted and the hunk is left unchanged.<br>
</div><br>After the deletes, the editors file should look like this.<br><div id="codeblock"># Manual hunk edit mode -- see bottom for a quick guide<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
# ---<br>
# To remove '-' lines, make them ' ' lines (context).<br>
# To remove '+' lines, delete them.<br>
# Lines starting with # will be removed.<br>
#<br>
# If the patch applies cleanly, the edited hunk will immediately be<br>
# marked for staging. If it does not apply cleanly, you will be given<br>
# an opportunity to edit again. If all lines of the hunk are removed,<br>
# then the edit is aborted and the hunk is left unchanged.<br>
</div><br>Once we quit our editor, we are then asked about the next hunk.
In our case, we are going to apply all of the changes to our second file during this commit.
To do this we are going to use the <span style="font-family:monospace;">a</span> option.<br><div id="codeblock">diff --git a/newfile2 b/newfile2<br>
index 3545c1d..40efcce 100644<br>
--- a/newfile2<br>
+++ b/newfile2<br>
@@ -1,2 +1,4 @@<br>
 Another new file<br>
 and a new awesome feature<br>
+This is a new line<br>
+This is another new line<br>
Stage this hunk [y,n,q,a,d,/,e,?]? a<br>
<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>At first glance, we do not appear to have been left with any indication that anything has taken place.
In order to perform a check we shall run out obligatory <span style="font-family:monospace;">git diff</span>, both between the working copy and the index, and between the index and the last commit.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git diff<br></strong>
diff --git a/newfile1 b/newfile1<br>
index f702b65..0eccf1a 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1 +1,4 @@<br>
 This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>So above, we can see that the difference between the working copy and the index, or staging area, is the last three lines that we are not ready to commit yet.
Below we can see the difference between the staging area and the last commit to the repository.
This includes the three lines that we included during our interactive commit preparation.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git diff --cached<br></strong>
diff --git a/newfile1 b/newfile1<br>
index 44640b2..f702b65 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1,2 +1 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
diff --git a/newfile2 b/newfile2<br>
index 3545c1d..40efcce 100644<br>
--- a/newfile2<br>
+++ b/newfile2<br>
@@ -1,2 +1,4 @@<br>
 Another new file<br>
 and a new awesome feature<br>
+This is a new line<br>
+This is another new line<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>We can now commit in the normal way, and continue to edit the working copy to stage the sections we require.
The following output is shortened for brevity.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git commit -m 'Added first line'<br></strong>
[fantasy 03bd20c] Added first line<br>
 2 files changed, 3 insertions(+), 2 deletions(-)<br>
<strong>john@satsuki:~/coderepo$ git add -p<br></strong>
diff --git a/newfile1 b/newfile1<br>
index f702b65..0eccf1a 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1 +1,4 @@<br>
 This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
Stage this hunk [y,n,q,a,d,/,e,?]? e<br>
<br>
<strong>john@satsuki:~/coderepo$ git commit -m 'Added second line'<br></strong>
[fantasy 302e3fa] Added second line<br>
 1 files changed, 1 insertions(+), 0 deletions(-)<br>
<strong>john@satsuki:~/coderepo$ git add -p<br></strong>
...<br>
...<br>
...<br>
</div><br>We have gone through the process of editing each hunk for each commit and have performed the commits.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git log<br></strong>
commit a59e73b1dc571318a1154aa4c2fc591ab6f1f395<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Wed Apr 13 23:56:39 2011 +0100<br>
<br>
    Added fourth line<br>
<br>
commit 3ca3d627a54418be4c2e9d9196db6ce62e2b93ff<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Wed Apr 13 23:56:13 2011 +0100<br>
<br>
    Added third line<br>
<br>
commit 302e3fa5f880a2a503235667b4c96d4dcdaa11be<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Wed Apr 13 23:55:57 2011 +0100<br>
<br>
    Added second line<br>
<br>
commit 03bd20cb8a78a28f003ab402492cf7055f21bb2e<br>
Author: John Haskins &lt;john.haskins@tamagoyakiinc.koala&gt;<br>
Date:   Wed Apr 13 23:55:32 2011 +0100<br>
<br>
    Added first line<br>
</div><br>Next we are going to see how to perform exactly the same procedure using <span style="font-family:monospace;">git gui</span>.
For a start, we are going to reset our branch HEAD and our index back to their state before we made the last four commits, however we are going to leave the working copy files in the state they were after these last four commits.
This is called a <strong>mixed</strong> reset, as it modifies the staging area and the HEAD, but does not touch the working files.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git log --oneline<br></strong>
a59e73b Added fourth line<br>
3ca3d62 Added third line<br>
302e3fa Added second line<br>
03bd20c Added first line<br>
d50ffb2 Merged in zaney<br>
ed2301b Removed third file<br>
...<br>
...<br>
<strong>john@satsuki:~/coderepo$ git reset --mixed d50ffb2<br></strong>
Unstaged changes after reset:<br>
M	newfile1<br>
M	newfile2<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>Now we will run a diff, just to be sure.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git diff<br></strong>
diff --git a/newfile1 b/newfile1<br>
index 44640b2..0eccf1a 100644<br>
--- a/newfile1<br>
+++ b/newfile1<br>
@@ -1,2 +1,4 @@<br>
-A new file<br>
-and some more awesome changes<br>
+This is line 1<br>
+This is line 2<br>
+This is line 3<br>
+This is line 4<br>
diff --git a/newfile2 b/newfile2<br>
index 3545c1d..40efcce 100644<br>
--- a/newfile2<br>
+++ b/newfile2<br>
@@ -1,2 +1,4 @@<br>
 Another new file<br>
 and a new awesome feature<br>
+This is a new line<br>
+This is another new line<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>If we now run our <span style="font-family:monospace;">git gui</span> command, we will see the changes that are present, once we click on one of the files in the left hand portion of the screen.
Let us start with <span style="font-family:monospace;">newfile2</span> as we want every change from that file present in this commit.
Figure 1 shows what <span style="font-family:monospace;">git gui</span> looks like at this stage.<br><center><table  border="0" cellpadding="0" cellspacing="0" class="image_float_left">
                    <tr>
                      <td style="padding:10px;"><img src="images/chaps/f-af5-d1.png" width="400" ></td>
                      <td class="fade_right">&nbsp;</td>
                    </tr>
                    <tr>
                      <td class="fade_bot_image"><div align="center"><strong>Figure 1</strong><br>Changes to <span style="font-family:monospace;">newfile2</span></div></td>
                      <td class="fade_corner">&nbsp;</td>
                    </tr>
                  </table></center><br>If we right click on one of the green lines, remembering that green is short for an <strong>addition</strong>, we get a menu which we have not seen before.
Among other things, this menu has the ability to stage a specific line or hunk for commit.
In our case we are going to hit the <strong>Stage Hunk For Commit</strong> and then move on to the next file, <span style="font-family:monospace;">newfile1</span>.<br><center><table  border="0" cellpadding="0" cellspacing="0" class="image_float_left">
                    <tr>
                      <td style="padding:10px;"><img src="images/chaps/f-af5-d2.png" width="400" ></td>
                      <td class="fade_right">&nbsp;</td>
                    </tr>
                    <tr>
                      <td class="fade_bot_image"><div align="center"><strong>Figure 2</strong><br>Changes to <span style="font-family:monospace;">newfile1</span></div></td>
                      <td class="fade_corner">&nbsp;</td>
                    </tr>
                  </table></center><br>Now we are looking at <span style="font-family:monospace;">newfile1</span>, we can use the <strong>Stage Line For Commit</strong> to add specific lines into the staging area.
The file is shown in Figure 2.
As our file is so small, we can run into problems if we just choose lines at random and stage them.
This is because it is hard for Git to find context around which to associate the change.
The context is the area immediately surrounding the change we are making.
In order to reduce the risk of the error occurring, we are simply going to start at the top, and select the first three lines for committing, by right clicking on each on in turn and choosing the <strong>Stage Line For Commit</strong> option from the menu.<br><br>We have the changes that we expect ready to be committed.
If we want to check one last time that they are right, we can use the <strong>Staged Changes</strong> pane on the left to choose the file and inspect the diff.
Once we are happy we can use the <strong>Commit</strong> area of the window to type our commit message and emblazon our changes forever.<br><center><table  border="0" cellpadding="0" cellspacing="0" class="image_float_left">
                    <tr>
                      <td style="padding:10px;"><img src="images/chaps/f-af5-d3.png" width="400" ></td>
                      <td class="fade_right">&nbsp;</td>
                    </tr>
                    <tr>
                      <td class="fade_bot_image"><div align="center"><strong>Figure 3</strong><br>Changes to <span style="font-family:monospace;">newfile1</span> after staging</div></td>
                      <td class="fade_corner">&nbsp;</td>
                    </tr>
                  </table></center><br>Figure 3, shows what our file looks like after the first commit.
Interestingly, as our file is so small, you will probably find that <span style="font-family:monospace;">git gui</span> throws a corrupt patch error if you try to just commit the next line.
As we mentioned earlier, it is always a good idea to know how to use the command line tools for precisely this reason.
Often you are dealing with special cases, that the GUI just can not handle.
In these cases, you may find you need to switch to the command line interface, to get the job done.<br><br>Let us now move back to our <strong>master</strong> branch and remove the <strong>fantasy</strong> branch.<br><div id="codeblock"><strong>john@satsuki:~/coderepo$ git checkout master<br></strong>
Switched to branch 'master'<br>
<strong>john@satsuki:~/coderepo$ git branch -D fantasy<br></strong>
Deleted branch fantasy (was 29ceede).<br>
<strong>john@satsuki:~/coderepo$<br></strong>
</div><br>Notice that because we used the capitol <span style="font-family:monospace;">-D</span> parameter, we were not asked if we were sure we wanted to delete the <strong>fantasy</strong> branch.<br><br>So in the <em>After Hours</em> section this week, we have found two ways to do the same complex task, one graphical and one command based.
Staging commits in this way may seem rather odd, but it will help you to keep your commits exceedingly exact.
Whilst this may not matter on a personal project, for Tamagoyaki Inc, grouping the right lines together in a commit will be an extremely useful process to have available.<table border="0" cellpadding="0" cellspacing="0" width="100%">
					<tr>
						<td><p align="left"><a href="chap5-4.html"><img src="images/prev.png" alt="Previous Day" height="29"></a></p></td>
						<td><p align="right"><a href="chap6-1.html"><img src="images/next.png" alt="Next Day" height="29"></a></p></td>
					</tr>
				</table>                  </td>
                <td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table></td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td class="foot"><a href="index.html">home</a> | <a href="download.html">download</a> | <a href="read.html">read now</a> | <a href="source.html">source</a> | <a href="feedback.html">feedback</a> | <a href="legal.html">legal stuff</a><br>
          <!--menu provided by <a href="http://apycom.com/">Apycom jQuery Menus</a>--></td>
      </tr>
    </table></td>
  </tr>
</table>
</body>
</html>
