<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Git In The Trenches</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<link type="text/css" href="menu.css" rel="stylesheet" />
	<script type="text/javascript" src="jquery.js"></script>
</head>

<body>
<table width="1000" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td class="logo"><a href="index.html"><img src="images/git_logo_new.png" alt="Git In The Trenches" height="61" border="0"></a></td>
            <td class="nav">
				<a href="index.html">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="download.html">Download Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="intro.html">Read Now</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="http://github.com/cbx33/gitt">Source</a>&nbsp;&nbsp;|&nbsp;&nbsp;
				<a href="feedback.html">Feeback</a>
			</td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td class="main_content_pad"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="309"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="subnav">
				<strong>Introduction</strong><br>
&bull;&nbsp;&nbsp;<a href="intro.html">How this book works</a><br>
<div class="divider"></div>
<strong>Setting up</strong><br>
&bull;&nbsp;&nbsp;<a href="setup.html">Making sure you have everything</a><br>
<div class="divider"></div>
<strong>Week 1</strong><br>
<span>&bull; Day 1 </span> - <a href="chap1-1.html"> "Things need to change"</a><br>
<span>&bull; Day 3 </span> - <a href="chap1-2.html"> "A possible solution"</a><br>
<span>&bull; Day 4 </span> - <a href="chap1-3.html"> "A decision is reached"</a><br>
<span>&bull; Day 5 </span> - <a href="chap1-4.html"> "Working like a team"</a><br>
<div class="divider"></div>
<strong>After Hours Week 1</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours1-1.html">"History Lesson"</a><br>
<div class="divider"></div>
<strong>Week 2</strong><br>
<span>&bull; Day 1 </span> - <a href="chap2-1.html"> "We are coders, we use Git!"</a><br>
<span>&bull; Day 2 </span> - <a href="chap2-2.html"> "Making commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap2-3.html"> "Let's do this right, not fast"</a><br>
<span>&bull; Summary </span> - <a href="chap2-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 2</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours2-1.html">"A Little Of Git's Internals"</a><br>
<div class="divider"></div>
<strong>Week 3</strong><br>
<span>&bull; Day 1 </span> - <a href="chap3-1.html"> "How do I see what's going on?"</a><br>
<span>&bull; Day 2 </span> - <a href="chap3-2.html"> "But I need more information"</a><br>
<span>&bull; Day 3 </span> - <a href="chap3-3.html"> "What actually changed?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap3-4.html"> "Finding a good reference point"</a><br>
<span>&bull; Day 5 </span> - <a href="chap3-5.html"> "Putting things back again"</a><br>
<span>&bull; Summary </span> - <a href="chap3-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 3</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours3-1.html">"A Closer Look At Diffs and Tags"</a><br>
<div class="divider"></div>
<strong>Week 4</strong><br>
<span>&bull; Day 1 </span> - <a href="chap4-1.html"> "We're getting somewhere"</a><br>
<span>&bull; Day 2 </span> - <a href="chap4-2.html"> "Branches galore"</a><br>
<span>&bull; Day 3 </span> - <a href="chap4-3.html"> "Tricking the twigs"</a><br>
<span>&bull; Day 4 </span> - <a href="chap4-4.html"> "I pressed delete..."</a><br>
<span>&bull; Day 5 </span> - <a href="chap4-5.html"> "Conflicting information"</a><br>
<span>&bull; Summary </span> - <a href="chap4-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 4</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-1.html">"Merge merge merge"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours4-2.html">"Grepping your life away"</a><br>
<div class="divider"></div>
<strong>Week 5</strong><br>
<span>&bull; Day 1 </span> - <a href="chap5-1.html"> "This isn't working for me John"</a><br>
<span>&bull; Day 2 </span> - <a href="chap5-2.html"> "Back to logging"</a><br>
<span>&bull; Day 4 </span> - <a href="chap5-3.html"> "Advanced Techniques"</a><br>
<span>&bull; Summary </span> - <a href="chap5-4.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 5</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours5-1.html">"Splitting up commits the easy way"</a><br>
<div class="divider"></div>
<strong>Week 6</strong><br>
<span>&bull; Day 1 </span> - <a href="chap6-1.html"> "My private little stash"</a><br>
<span>&bull; Day 2 </span> - <a href="chap6-2.html"> "What?! No backup?"</a><br>
<span>&bull; Day 3 </span> - <a href="chap6-3.html"> "Is this clone for real?"</a><br>
<span>&bull; Day 4 </span> - <a href="chap6-4.html"> "Help I'm no longer up to date?"</a><br>
<span>&bull; Day 5 </span> - <a href="chap6-5.html"> "I'm putting my foot down"</a><br>
<span>&bull; Summary </span> - <a href="chap6-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 6</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-1.html">"Tug of war"</a><br>
&bull;&nbsp;&nbsp;<a href="afterhours6-2.html">"Referring to objects"</a><br>
<div class="divider"></div>
<strong>Week 7</strong><br>
<span>&bull; Day 1 </span> - <a href="chap7-1.html"> "Networking with a difference"</a><br>
<span>&bull; Day 2 </span> - <a href="chap7-2.html"> "Now let's work together"</a><br>
<span>&bull; Day 3 </span> - <a href="chap7-3.html"> "Rebasing our commitments"</a><br>
<span>&bull; Day 4 </span> - <a href="chap7-4.html"> "Starting to get rebased"</a><br>
<span>&bull; Day 5 </span> - <a href="chap7-5.html"> "I could rebase the world"</a><br>
<span>&bull; Summary </span> - <a href="chap7-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 7</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours7-1.html">"Network Communicating"</a><br>
<div class="divider"></div>
<strong>Week 8</strong><br>
<span>&bull; Day 1 </span> - <a href="chap8-1.html"> "Give a man a patch"</a><br>
<span>&bull; Day 2 </span> - <a href="chap8-2.html"> "Looking for problems"</a><br>
<span>&bull; Day 3 </span> - <a href="chap8-3.html"> "Filtered repos"</a><br>
<span>&bull; Day 4 </span> - <a href="chap8-4.html"> "Let's make a library"</a><br>
<span>&bull; Day 5 </span> - <a href="chap8-5.html"> "Shhh....we're in a library"</a><br>
<span>&bull; Summary </span> - <a href="chap8-6.html"> John's Notes</a><br>
<div class="divider"></div>
<strong>After Hours Week 8</strong><br>
&bull;&nbsp;&nbsp;<a href="afterhours8-1.html">"Fishing for beginners"</a><br>
<div class="divider"></div>
<strong>A little extra help</strong><br>
&bull;&nbsp;&nbsp;<a href="chap9-1.html">Taking things further</a><br>
&bull;&nbsp;&nbsp;<a href="chap9-2.html">The end of the journey</a><br>
<div class="divider"></div>

				
				<td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table>              <h1>&nbsp;</h1>
              </td>
            <td><table width="100%"  border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td class="read_content">
<h1>Week 6</h1><h2>"Tug of war"</h2>
<h3>Taking the push with the pull</h3>
We have spoken in fairly great length about how remote repositories work.
We have seen how the <code class="ncode">git remote</code> tool is used to create the various references to remote repositories, but we have no real understanding about what this means in terms of Git's internals.
Just in the same way a branch is a single file that contains a pointer to a reference, a remote repository has to be handled within Git somehow.<br><br>As it happens, Git again uses a reasonably simplistic design when creating remote references.
To take a look at this in detail, we need to once again delve into the <code class="ncode">.git</code> directory.
Seeing as our original repository does not contain any remotes for now, we are going to use our <code class="ncode">coderepo-cl</code> folder as an example.
Hopefully, if you have been following the text, you have not deleted this directory yet.
If you have, do not worry, just follow the operations we completed in Week 6, or read on and use the text in the book.<br><br>If you remember, we created two clones of our original repository.
Once was a simple clone called <code class="ncode">coderepo-cl</code> and the other was a bare repository called <code class="ncode">coderepo-bk</code>.
The <code class="ncode">coderepo-cl</code> and the <code class="ncode">coderepo-bk</code> repositories were both cloned from <code class="ncode">coderepo</code>, but it was <code class="ncode">coderepo-cl</code> that was configured to pull from one and push to the other.
Running a simple <code class="ncode">git remote -v</code> command, confirms this configuration.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo-cl$ git remote -v<br></strong>
backup	/home/john/coderepo-bk (fetch)<br>
backup	/home/john/coderepo-bk (push)<br>
origin	/home/john/coderepo (fetch)<br>
origin	/home/john/coderepo (push)<br>
<strong>john@satsuki:~/coderepo-cl$<br></strong>
</code></div><br>We can get even more information by running the <code class="ncode">git remote show</code> tool with the remote name as a parameter.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo-cl$ git remote show origin<br></strong>
* remote origin<br>
  Fetch URL: /home/john/coderepo<br>
  Push  URL: /home/john/coderepo<br>
  HEAD branch: master<br>
  Remote branches:<br>
    master    tracked<br>
    wonderful tracked<br>
    zaney     tracked<br>
  Local branches configured for 'git pull':<br>
    master    merges with remote master<br>
    wonderful merges with remote wonderful<br>
  Local refs configured for 'git push':<br>
    master    pushes to master    (up to date)<br>
    wonderful pushes to wonderful (up to date)<br>
<strong>john@satsuki:~/coderepo-cl$<br></strong>
</code></div><br>How though, is this data set up and configured from within Git itself?
Looking at the <code class="ncode">.git/config</code> file, we can see a glimpse of this.<br><div id="codeblock"><code><strong>john@satsuki:~/coderepo-cl$ cat .git/config<br></strong>
[core]<br>
	repositoryformatversion = 0<br>
	filemode = true<br>
	bare = false<br>
	logallrefupdates = true<br>
[remote "origin"]<br>
	fetch = +refs/heads/*:refs/remotes/origin/*<br>
	url = /home/john/coderepo<br>
[branch "master"]<br>
	remote = origin<br>
	merge = refs/heads/master<br>
[branch "wonderful"]<br>
	remote = origin<br>
	merge = refs/heads/wonderful<br>
[remote "backup"]<br>
	url = /home/john/coderepo-bk<br>
	fetch = +refs/heads/*:refs/remotes/backup/*<br>
<strong>john@satsuki:~/coderepo-cl$<br></strong>
</code></div><br>As you can see there are two relevant sections, these are the <code class="ncode">remote</code> and <code class="ncode">branch</code> stanzas.
The <code class="ncode">remote</code> stanzas are there to define certain elements of the remote repository, 
whilst the <code class="ncode">branch</code> stanzas describe elements and settings for the branches that we are tracking.
Let us look at the relevant elements that we have set out in <code class="ncode">config</code> file for each type of stanza.<br><br>We will start by looking at the <code class="ncode">remote</code> stanza. We have two settings here in our configuration.
The first is <code class="ncode">url</code> and the second is <code class="ncode">fetch</code>.
The <code class="ncode">url</code> setting tells Git the location of the remote repository defined by the name outlined within the quotation marks.
In our example, the remote we first encounter is called <strong>origin</strong> and has a url of <code class="ncode">/home/john/coderepo</code>.<br><br>You will notice that there is also a second setting called <code class="ncode">fetch</code>.
This setting tells Git which branches, or HEADs we are interested in. In the default configuration, we ask Git to fetch all branch HEADs.
This also has an effect on which objects are downloaded.
Git will look at all of the branch HEADs and work backwards to find out which commit objects need to be downloaded.<br><br>In the <code class="ncode">refs/</code> folder there are two other folders by default called <code class="ncode">tags</code> and <code class="ncode">remotes</code>.
With the default configuration as above, these references will not be fetched,
and commits that are only pointed to by these references will not be downloaded either.<br><br>Looking at the <code class="ncode">branch</code> settings, we can see that there are a few more settings here that describe how Git responds to certain commands when inside a certain branch.
In both the cases above, Git will automatically use remote of <strong>origin</strong> as the remote to use when performing operations.
This means that when we run a <code class="ncode">git pull</code>, we do not have to specify a remote to pull from.
Obviously if we wanted to, we could change this and have <strong>wonderful</strong>, for example, update from a different remote repository.<br><br>The last setting in this file that we will concern ourselves with is the <code class="ncode">merge</code> setting.  
When we are in the named branch, this setting defines the upstream version of the named branch and is used for merging and can affect pulling and rebasing too.<br><br>We can set these settings and any of the others in the <code class="ncode">config</code> file manually,
using the <code class="ncode">git config</code> tool, which we used in a previous chapter.<br><br><table border="0" cellpadding="0" cellspacing="0" width="100%">
					<tr>
						<td><p align="left"><a href="chap6-6.html"><img src="images/prev.png" alt="Previous Day" height="29"></a></p></td>
						<td><p align="right"><a href="afterhours6-2.html"><img src="images/next.png" alt="Next Day" height="29"></a></p></td>
					</tr>
				</table>                  </td>
                <td class="fade_right">&nbsp;</td>
              </tr>
              <tr>
                <td class="fade_bot">&nbsp;</td>
                <td class="fade_corner">&nbsp;</td>
              </tr>
            </table></td>
            </tr>
          </table>
		</td>
      </tr>
      <tr>
        <td class="foot"><a href="index.html">home</a> | <a href="download.html">download</a> | <a href="read.html">read now</a> | <a href="source.html">source</a> | <a href="feedback.html">feedback</a> | <a href="legal.html">legal stuff</a><br>
        </td>
      </tr>
    </table></td>
  </tr>
</table>
</body>
</html>
